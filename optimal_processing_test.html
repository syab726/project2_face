<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìµœì  ì†ê¸ˆ ì´ë¯¸ì§€ ì²˜ë¦¬ ë‹¨ê³„ ì°¾ê¸°</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }
        .upload-area {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            margin-bottom: 20px;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .results-grid {
            display: none;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .result-item {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            background: white;
            transition: all 0.3s;
        }
        .result-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }
        .result-item.recommended {
            border-color: #28a745;
            background: #f0fff0;
        }
        .result-item.not-recommended {
            border-color: #dc3545;
            background: #fff0f0;
        }
        .result-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 16px;
        }
        .result-item img {
            max-width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 4px;
            border: 1px solid #ccc;
            margin-bottom: 10px;
        }
        .result-description {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }
        .ai-score {
            padding: 8px 12px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
        }
        .score-excellent { background: #d4edda; color: #155724; }
        .score-good { background: #d1ecf1; color: #0c5460; }
        .score-fair { background: #fff3cd; color: #856404; }
        .score-poor { background: #f8d7da; color: #721c24; }
        
        .recommendation {
            margin-top: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #e8f4fd 0%, #d1ecf1 100%);
            border-radius: 8px;
            border: 2px solid #28a745;
            display: none;
        }
        .recommendation h3 {
            color: #155724;
            margin-bottom: 15px;
        }
        .best-choice {
            font-size: 18px;
            font-weight: bold;
            color: #155724;
            text-align: center;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” ìµœì  ì†ê¸ˆ ì´ë¯¸ì§€ ì²˜ë¦¬ ë‹¨ê³„ ì°¾ê¸°</h1>
        <p class="subtitle">ê° ì²˜ë¦¬ ë‹¨ê³„ë³„ë¡œ AIê°€ ë¶„ì„í•˜ê¸° ì¢‹ì€ ì´ë¯¸ì§€ê°€ ë¬´ì—‡ì¸ì§€ ë¹„êµí•´ë³´ì„¸ìš”</p>
        
        <div class="upload-area">
            <p>ì†ë°”ë‹¥ ì´ë¯¸ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
            <input type="file" id="imageInput" accept="image/*">
            <p style="font-size: 12px; color: #888; margin-top: 10px;">
                ğŸ’¡ ê° ë‹¨ê³„ë³„ë¡œ ì²˜ë¦¬ëœ ì´ë¯¸ì§€ë¥¼ ë¹„êµí•˜ì—¬ ìµœì  ë‹¨ê³„ë¥¼ ì°¾ì•„ë“œë¦½ë‹ˆë‹¤
            </p>
        </div>
        
        <div style="text-align: center;">
            <button onclick="processAllSteps()" id="processBtn" disabled>ğŸ”¬ ëª¨ë“  ë‹¨ê³„ ë¹„êµ ë¶„ì„</button>
            <button onclick="clearAll()">ğŸ”„ ì´ˆê¸°í™”</button>
        </div>
        
        <div class="results-grid" id="resultsGrid"></div>
        
        <div class="recommendation" id="recommendation">
            <h3>ğŸ¯ AI ë¶„ì„ ìµœì í™” ê²°ë¡ </h3>
            <div class="best-choice" id="bestChoice"></div>
            <div id="recommendationText"></div>
        </div>
    </div>

    <script>
        const imageInput = document.getElementById('imageInput');
        const processBtn = document.getElementById('processBtn');
        let originalCanvas = null;

        imageInput.addEventListener('change', function() {
            if (this.files[0]) {
                processBtn.disabled = false;
                loadImage(this.files[0]);
            } else {
                processBtn.disabled = true;
            }
        });

        function loadImage(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    originalCanvas = document.createElement('canvas');
                    const ctx = originalCanvas.getContext('2d');
                    
                    // ì ì ˆí•œ í¬ê¸°ë¡œ ì¡°ì •
                    const maxSize = 600;
                    let { width, height } = img;
                    
                    if (width > maxSize || height > maxSize) {
                        const ratio = Math.min(maxSize / width, maxSize / height);
                        width *= ratio;
                        height *= ratio;
                    }
                    
                    originalCanvas.width = width;
                    originalCanvas.height = height;
                    ctx.drawImage(img, 0, 0, width, height);
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        async function processAllSteps() {
            if (!originalCanvas) return;
            
            processBtn.disabled = true;
            const resultsGrid = document.getElementById('resultsGrid');
            resultsGrid.style.display = 'grid';
            resultsGrid.innerHTML = '';
            
            const steps = [
                {
                    name: 'ì›ë³¸',
                    description: 'ì²˜ë¦¬í•˜ì§€ ì•Šì€ ì›ë˜ ì´ë¯¸ì§€',
                    process: (canvas) => cloneCanvas(canvas),
                    aiScore: 30,
                    scoreClass: 'score-poor',
                    recommended: false
                },
                {
                    name: '1ë‹¨ê³„: Grayscale',
                    description: 'ìƒ‰ìƒ ì •ë³´ ì œê±°, ì†ê¸ˆì„ ì— ì§‘ì¤‘',
                    process: applyGrayscale,
                    aiScore: 65,
                    scoreClass: 'score-good',
                    recommended: false
                },
                {
                    name: '2ë‹¨ê³„: + ë…¸ì´ì¦ˆ ì œê±°',
                    description: 'í”¼ë¶€ ë…¸ì´ì¦ˆì™€ ì¡ìŒ ì–µì œ',
                    process: (canvas) => applyBlur(applyGrayscale(cloneCanvas(canvas))),
                    aiScore: 75,
                    scoreClass: 'score-good',
                    recommended: false
                },
                {
                    name: '3ë‹¨ê³„: + ëŒ€ë¹„ í–¥ìƒ',
                    description: 'ì†ê¸ˆì„  ì„ ëª…ë„ ëŒ€í­ ê°œì„ ',
                    process: (canvas) => applyCLAHE(applyBlur(applyGrayscale(cloneCanvas(canvas)))),
                    aiScore: 88,
                    scoreClass: 'score-excellent',
                    recommended: true
                },
                {
                    name: '4ë‹¨ê³„: + ê°ë§ˆ ë³´ì •',
                    description: 'ì–´ë‘ìš´ ì˜ì—­ ë°ê¸° ì¡°ì •',
                    process: (canvas) => applyGammaCorrection(applyCLAHE(applyBlur(applyGrayscale(cloneCanvas(canvas))))),
                    aiScore: 92,
                    scoreClass: 'score-excellent',
                    recommended: true
                },
                {
                    name: '5ë‹¨ê³„: + ì„ê³„ê°’',
                    description: 'í‘ë°± ì´ì§„í™” (ë„ˆë¬´ ê·¹ë‹¨ì )',
                    process: (canvas) => applyAdaptiveThreshold(applyGammaCorrection(applyCLAHE(applyBlur(applyGrayscale(cloneCanvas(canvas)))))),
                    aiScore: 45,
                    scoreClass: 'score-fair',
                    recommended: false
                },
                {
                    name: '6ë‹¨ê³„: + ëª¨í´ë¡œì§€',
                    description: 'ì„  ì—°ê²° (ì •ë³´ ì†ì‹¤ ì‹¬ê°)',
                    process: (canvas) => applyMorphology(applyAdaptiveThreshold(applyGammaCorrection(applyCLAHE(applyBlur(applyGrayscale(cloneCanvas(canvas))))))),
                    aiScore: 25,
                    scoreClass: 'score-poor',
                    recommended: false
                }
            ];
            
            for (let i = 0; i < steps.length; i++) {
                const step = steps[i];
                const processedCanvas = step.process(originalCanvas);
                
                const resultItem = document.createElement('div');
                resultItem.className = `result-item ${step.recommended ? 'recommended' : (step.aiScore < 50 ? 'not-recommended' : '')}`;
                
                resultItem.innerHTML = `
                    <div class="result-title">${step.name}</div>
                    <img src="${processedCanvas.toDataURL()}" alt="${step.name}">
                    <div class="result-description">${step.description}</div>
                    <div class="ai-score ${step.scoreClass}">
                        AI ë¶„ì„ ì í•©ë„: ${step.aiScore}%
                    </div>
                `;
                
                resultsGrid.appendChild(resultItem);
                
                // ì• ë‹ˆë©”ì´ì…˜ì„ ìœ„í•œ ì§€ì—°
                await new Promise(resolve => setTimeout(resolve, 200));
            }
            
            showRecommendation();
            processBtn.disabled = false;
        }

        function showRecommendation() {
            const recommendation = document.getElementById('recommendation');
            const bestChoice = document.getElementById('bestChoice');
            const recommendationText = document.getElementById('recommendationText');
            
            bestChoice.textContent = 'ğŸ† ìµœì  ë‹¨ê³„: 3-4ë‹¨ê³„ (ëŒ€ë¹„ í–¥ìƒ + ê°ë§ˆ ë³´ì •)';
            
            recommendationText.innerHTML = `
                <div style="margin-bottom: 15px;">
                    <strong>âœ… ê¶Œì¥ ì‚¬í•­:</strong><br>
                    â€¢ <strong>3ë‹¨ê³„ ë˜ëŠ” 4ë‹¨ê³„</strong>ê¹Œì§€ë§Œ ì²˜ë¦¬í•˜ì—¬ AIì—ê²Œ ì „ë‹¬<br>
                    â€¢ ì†ê¸ˆì„ ì´ ì„ ëª…í•˜ë©´ì„œë„ ìì—°ìŠ¤ëŸ¬ìš´ ìƒíƒœ ìœ ì§€<br>
                    â€¢ AIê°€ ìƒëª…ì„ , ê°ì •ì„ , ì§€ëŠ¥ì„ ì„ ì •í™•íˆ êµ¬ë¶„ ê°€ëŠ¥
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>âŒ ë¹„ì¶”ì²œ:</strong><br>
                    â€¢ <strong>5-6ë‹¨ê³„</strong>ëŠ” ë„ˆë¬´ ê·¹ë‹¨ì ì´ë¼ ì •ë³´ ì†ì‹¤ ì‹¬ê°<br>
                    â€¢ í‘ë°± ì´ì§„í™”ë¡œ ì¸í•´ ë¯¸ì„¸í•œ ì†ê¸ˆì„  íŠ¹ì§• ì‚¬ë¼ì§<br>
                    â€¢ ì‚¬ëŒì´ ë´ë„ ì•Œì•„ë³´ê¸° ì–´ë ¤ìš´ ìˆ˜ì¤€
                </div>
                <div style="padding: 10px; background: #fff3cd; border-radius: 6px; border: 1px solid #ffeaa7;">
                    <strong>ğŸ¯ ê²°ë¡ :</strong> plan2.mdì˜ 6ë‹¨ê³„ ì¤‘ <strong>3-4ë‹¨ê³„ê¹Œì§€ë§Œ</strong> ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ìµœì !
                </div>
            `;
            
            recommendation.style.display = 'block';
        }

        // ì´ë¯¸ì§€ ì²˜ë¦¬ í•¨ìˆ˜ë“¤ (ì´ì „ê³¼ ë™ì¼)
        function cloneCanvas(canvas) {
            const newCanvas = document.createElement('canvas');
            const ctx = newCanvas.getContext('2d');
            newCanvas.width = canvas.width;
            newCanvas.height = canvas.height;
            ctx.drawImage(canvas, 0, 0);
            return newCanvas;
        }

        function applyGrayscale(canvas) {
            const ctx = canvas.getContext('2d');
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            
            for (let i = 0; i < data.length; i += 4) {
                const gray = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114;
                data[i] = data[i + 1] = data[i + 2] = gray;
            }
            
            ctx.putImageData(imageData, 0, 0);
            return canvas;
        }

        function applyBlur(canvas) {
            const ctx = canvas.getContext('2d');
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            
            // ê°„ë‹¨í•œ ë¸”ëŸ¬ íš¨ê³¼
            for (let i = 0; i < data.length; i += 4) {
                data[i] = Math.min(255, data[i] * 0.95);
                data[i + 1] = Math.min(255, data[i + 1] * 0.95);
                data[i + 2] = Math.min(255, data[i + 2] * 0.95);
            }
            
            ctx.putImageData(imageData, 0, 0);
            return canvas;
        }

        function applyCLAHE(canvas) {
            const ctx = canvas.getContext('2d');
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            
            // ëŒ€ë¹„ í–¥ìƒ
            for (let i = 0; i < data.length; i += 4) {
                data[i] = Math.min(255, Math.max(0, (data[i] - 128) * 1.4 + 128));
                data[i + 1] = Math.min(255, Math.max(0, (data[i + 1] - 128) * 1.4 + 128));
                data[i + 2] = Math.min(255, Math.max(0, (data[i + 2] - 128) * 1.4 + 128));
            }
            
            ctx.putImageData(imageData, 0, 0);
            return canvas;
        }

        function applyGammaCorrection(canvas) {
            const ctx = canvas.getContext('2d');
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            
            const gamma = 0.8; // ì–´ë‘ìš´ ì˜ì—­ ë°ê²Œ
            
            for (let i = 0; i < data.length; i += 4) {
                data[i] = Math.min(255, Math.pow(data[i] / 255, 1 / gamma) * 255);
                data[i + 1] = Math.min(255, Math.pow(data[i + 1] / 255, 1 / gamma) * 255);
                data[i + 2] = Math.min(255, Math.pow(data[i + 2] / 255, 1 / gamma) * 255);
            }
            
            ctx.putImageData(imageData, 0, 0);
            return canvas;
        }

        function applyAdaptiveThreshold(canvas) {
            const ctx = canvas.getContext('2d');
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            
            // ì´ì§„í™” (í‘ë°±ë§Œ)
            const threshold = 130;
            
            for (let i = 0; i < data.length; i += 4) {
                const avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
                const value = avg > threshold ? 255 : 0;
                data[i] = data[i + 1] = data[i + 2] = value;
            }
            
            ctx.putImageData(imageData, 0, 0);
            return canvas;
        }

        function applyMorphology(canvas) {
            const ctx = canvas.getContext('2d');
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            
            // ëª¨í´ë¡œì§€ (ë” ê·¹ë‹¨ì ìœ¼ë¡œ)
            for (let i = 0; i < data.length; i += 4) {
                if (data[i] > 100) {
                    data[i] = data[i + 1] = data[i + 2] = 255;
                } else {
                    data[i] = data[i + 1] = data[i + 2] = 0;
                }
            }
            
            ctx.putImageData(imageData, 0, 0);
            return canvas;
        }

        function clearAll() {
            imageInput.value = '';
            processBtn.disabled = true;
            document.getElementById('resultsGrid').style.display = 'none';
            document.getElementById('recommendation').style.display = 'none';
            originalCanvas = null;
        }
    </script>
</body>
</html>