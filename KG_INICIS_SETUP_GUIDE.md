# KG이니시스 결제 시스템 설정 가이드

## 1단계: 테스트 환경 설정 (현재 상황)

### 테스트 계정 발급
1. KG이니시스 홈페이지 접속 (https://www.inicis.com)
2. "개발자센터" → "테스트 신청"
3. 테스트 MID, SignKey 발급 (즉시 발급)

### 환경변수 설정 (.env.local)
```env
KG_INICIS_MID=INIpayTest
KG_INICIS_SIGNKEY=SU5JTElURV9UUklQTEVERVNfS0VZU1RS
KG_INICIS_API_URL=https://api.inicis.com
KG_INICIS_TEST_MODE=true
```

### 테스트 결과
- ✅ 결제 화면: 실제와 동일
- ✅ 결제 프로세스: 실제와 동일  
- ⚠️ 실제 결제: 되지 않음 (가상 결제)
- ✅ UX 체험: 완전히 동일

## 2단계: 프로덕션 환경 준비

### 계약 체결 필요 서류
1. **사업자등록증** (개인사업자 또는 법인)
2. **통장사본** (정산 받을 계좌)
3. **대표자 신분증**
4. **사업 설명서** (웹사이트 URL, 판매 상품 설명)

### 심사 과정
- 서류 제출 → 심사 (3-5 영업일) → 승인 → MID 발급
- **주의**: 디지털 콘텐츠는 일반 상품보다 심사가 까다로움

### 프로덕션 환경변수
```env
KG_INICIS_MID=실제발급받은MID
KG_INICIS_SIGNKEY=실제발급받은SignKey  
KG_INICIS_API_URL=https://api.inicis.com
KG_INICIS_TEST_MODE=false
```

## 3단계: 현재 시스템에서 변경할 부분

### 즉시 변경 가능 (환경변수만)
- ✅ MID, SignKey 교체
- ✅ TEST_MODE를 false로 변경
- ✅ 나머지 코드는 그대로 사용 가능

### 추후 개선 권장 사항
1. **서명 생성 보안 강화**
   - 현재: 클라이언트에서 서명 생성 (보안 취약)
   - 개선: 서버 API에서 서명 생성

2. **데이터베이스 연동**
   - 현재: 메모리 저장
   - 개선: 실제 DB에 주문/결제 내역 저장

3. **웹훅 처리**
   - 결제 완료 시 이니시스에서 서버로 알림
   - 더 안전한 결제 검증

## 4단계: 비용 및 수수료

### KG이니시스 수수료 (일반적)
- **신용카드**: 3.3% ~ 3.5%
- **가입비/월 사용료**: 보통 무료 (매출 기준 협상)
- **정산주기**: T+2 또는 T+3 (영업일 기준)

### 예상 정산 금액 (2,900원 결제시)
- 고객 결제: 2,900원
- 수수료 (3.4%): 98원
- 실제 정산: 2,802원

## 현재 상황 요약

🟢 **테스트 환경 준비 완료**
- 코드 구현 완료
- 테스트 가능한 상태
- UX 동일한 경험 제공

🟡 **프로덕션 전환 준비**
- KG이니시스 계약만 체결하면 됨
- 환경변수 교체만으로 즉시 적용 가능
- 코드 수정 불필요

🔴 **주의사항**
- TEST_MODE=false로 변경하는 순간부터 **실제 결제 발생**
- 반드시 충분한 테스트 후 전환할 것
- 첫 결제 전에 소액으로 테스트 권장